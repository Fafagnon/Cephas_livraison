<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="images/png" href="images/Logo noir.png">
    <meta name="description" content="Commandez vos plats pr√©f√©r√©s √† Lom√© et √† Ab√©ho - Livraison rapide">
    <title>275 Fast-Food - Livraison de repas √† Lom√© et An√©ho</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- HEADER -->
    <header class="header transparent" id="header">
        <div class="header-container">
            <!-- Logo - REMPLACER .logo-image par <img src="logo.png" alt="D√©lice Lom√©"> -->
            <a href="#" class="logo">
               <img src="images/Logo noir.png" alt="275 Fast-Food" class="logo-image">                
               <span class="logo-text">275 Fast-Food</span>
            </a>

            <!-- Menu hamburger -->
            <button class="hamburger" id="hamburger" aria-label="Menu">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>

            <!-- Menu mobile -->
            <div class="mobile-menu" id="mobileMenu">
                <nav>
                    <a href="#menu">Notre Menu</a>
                    <a href="#order">Commander</a>
                    <a href="tel:+22896403078">Nous Appeler</a>
                    <a href="#about">√Ä Propos</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Overlay menu -->
    <div class="menu-overlay" id="menuOverlay"></div>

    <!-- HERO -->
    <section class="hero" id="heroSection">
        <!-- Carousel d'images de fond -->
        <div class="hero-carousel" id="heroCarousel">
            <!-- REMPLACER LES SRC PAR VOS VRAIES IMAGES -->
            <div class="hero-slide active">
                <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=1600" alt="Plats d√©licieux">
                <!-- REMPLACER PAR : <img src="images/hero-1.jpg" alt="Plats d√©licieux"> -->
            </div>
            <div class="hero-slide">
                <img src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=1600" alt="Cuisine locale">
                <!-- REMPLACER PAR : <img src="images/hero-2.jpg" alt="Cuisine locale"> -->
            </div>
            <div class="hero-slide">
                <img src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=1600" alt="Livraison rapide">
                <!-- REMPLACER PAR : <img src="images/hero-3.jpg" alt="Livraison rapide"> -->
            </div>
        </div>
        
        <!-- Overlay pour contraste texte -->
        <div class="hero-overlay"></div>
        
        <!-- Points de navigation -->
        <div class="carousel-dots" id="carouselDots">
            <button class="carousel-dot active" aria-label="Image 1" data-slide="0"></button>
            <button class="carousel-dot" aria-label="Image 2" data-slide="1"></button>
            <button class="carousel-dot" aria-label="Image 3" data-slide="2"></button>
        </div>
        
        <div class="hero-content">
            <span class="delivery-badge">Livraison √† Lom√© & An√©ho</span>
            <h1 class="hero-title">Les saveurs d‚Äôici, livr√©es chez vous</h1>
            <p class="hero-subtitle">Commandez vos plats pr√©f√©r√©s, nous pr√©parons et livrons. Paiement √† la livraison</p>
            <a href="#menu" class="cta-button">Commander maintenant</a>
        </div>
    </section>

    <!-- MENU -->
    <section class="menu-section" id="menu">
        <h2 class="section-title">Notre Menu</h2>
        <div class="menu-grid" id="menuGrid"></div>
    </section>

    <!-- EXTRAS -->
    <section class="extras-section">
        <h2 class="section-title">Nos Boissons</h2>
        <div class="extras-grid" id="extrasGrid"></div>
    </section>

    <!-- ORDER FORM -->
    <section class="order-section" id="order">
        <h2 class="section-title">Finaliser ma commande</h2>
        <form class="order-form" id="orderForm">
            <div class="cart-summary" id="cartSummary">
                <div class="cart-empty">Votre panier est vide</div>
            </div>

            <div class="form-group">
                <label class="form-label" for="name">Votre nom *</label>
                <input type="text" id="name" class="form-input" required placeholder="Ex: Koffi Mensah">
            </div>

            <div class="form-group">
                <label class="form-label" for="phone">T√©l√©phone *</label>
                <input type="tel" id="phone" class="form-input" required placeholder="Ex: 90 12 34 56">
            </div>

            <div class="form-group">
                <label class="form-label" for="location">
                    Localisation GPS <span class="form-label-optional">(optionnel)</span>
                </label>
                <input type="text" id="location" class="form-input" readonly placeholder="Position GPS (√† d√©tecter)">
                <button type="button" class="geo-button" id="geoButton" onclick="getLocation()">
                    <span class="icon">üìç</span>
                    <span id="geoButtonText">Utiliser ma position actuelle</span>
                </button>
                <div class="geo-status" id="geoStatus"></div>
            </div>

            <div class="form-group">
                <label class="form-label" for="quartier">Rep√®re / Quartier *</label>
                <input type="text" id="quartier" class="form-input" required placeholder="Ex: Ny√©konakpo√®, pr√®s de l'√©glise">
            </div>

            <div class="form-group">
                <label class="form-label" for="time">Heure souhait√©e *</label>
                <input type="text" id="time" class="form-input" required placeholder="Ex: 13h00 ou d√®s que possible">
            </div>

            <div class="form-group">
                <label class="form-label" for="notes">Indications compl√©mentaires (optionnel)</label>
                <textarea id="notes" class="form-input" rows="3" placeholder="Ex: Maison blanche √† c√¥t√© de l'√©glise"></textarea>
            </div>

            <button type="submit" class="submit-button" id="submitBtn" disabled>
                <span>üì±</span>
                <span>Envoyer la commande par WhatsApp</span>
            </button>
        </form>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="footer-contact">
            <p>üìû <a href="tel:+22890123456">+228 96 40 30 78</a></p>
            <p>üìç Lom√©, Togo</p>
        </div>
        <p style="font-size: 0.9rem; opacity: 0.8;">Paiement √† la livraison ‚Ä¢ Livraison rapide</p>
    </footer>

    <!-- SUCCESS MODAL -->
    <div class="menu-overlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center; padding: 1rem;" id="successModal">
        <div style="background: white; padding: 2rem; border-radius: 16px; max-width: 400px; text-align: center; animation: slideUp 0.3s ease;">
            <div style="font-size: 4rem; margin-bottom: 1rem;">‚úÖ</div>
            <h3 style="font-size: 1.5rem; margin-bottom: 0.5rem; color: var(--text-dark);">Commande envoy√©e !</h3>
            <p style="color: var(--text-light); margin-bottom: 1.5rem;">Nous avons bien re√ßu votre commande. Nous vous contactons tr√®s vite.</p>
            <button style="background: var(--primary); color: white; border: none; padding: 1rem 2rem; font-size: 1rem; font-weight: 600; border-radius: 50px; cursor: pointer;" onclick="closeSuccessModal()">Fermer</button>
        </div>
    </div>

    <!-- MODAL OPTIONS PLAT -->
    <div class="options-overlay" id="optionsOverlay"></div>
    <div class="dish-options-modal" id="dishOptionsModal">
        <div class="modal-header">
            <div class="modal-handle"></div>
            <h3 class="modal-title" id="modalDishName"></h3>
            <p class="modal-price" id="modalDishPrice"></p>
        </div>

        <div class="modal-body" id="modalBody">
            <!-- Options dynamiques ins√©r√©es ici -->
        </div>

        <div class="modal-footer">
            <div class="quantity-selector">
                <button type="button" onclick="decreaseModalQuantity()">‚àí</button>
                <span class="quantity" id="modalQuantity">1</span>
                <button type="button" onclick="increaseModalQuantity()">+</button>
            </div>
            <button class="add-to-cart-btn" id="addToCartBtn" disabled onclick="addDishToCart()">
                Ajouter √† la commande
            </button>
        </div>
    </div>

    <script>
        // ===== DONN√âES DES PLATS =====
        const dishes = [
            // ========================================
            // PLAT AVEC OPTIONS : SPAGHETTI (NOUVEAU)
            // Ce plat affiche une modal pour choisir avec/sans mayo
            // ========================================
            {
                id: 'spaghetti',
                name: 'Spaghetti',
                description: 'Accompagn√© de viande de b≈ìuf, saucisse & 2 ≈ìufs',
                price: 3500,
                image: 'images/spaghetti.jpg',
                options: {
                    type: 'radio',
                    label: 'Choisissez votre pr√©f√©rence',
                    required: true,
                    choices: [
                        { id: 'avec-mayo', label: 'Avec mayonnaise' },
                        { id: 'sans-mayo', label: 'Sans mayonnaise' }
                    ]
                }
            },
            {
                id: 'akpan',
                name: 'Akpan',
                description: 'Accompagn√© de sauce tomate et poisson frit',
                price: 2195,
                image: 'images/Akpan.jpg',
                options: {
                    type: 'radio',
                    label: 'Choisissez votre pr√©f√©rence',
                    required: true,
                    choices: [
                        { id: 'poisson braise', label: 'Avec poisson brais√©' },
                        { id: 'poisson frit', label: 'Avec poisson frit' }
                    ]
                }
            },
            {
                id: 'attieke',
                name: 'Atti√©k√© et poisson',
                description: 'Semoule de manioc ferment√© avec poisson frit',
                price: 2480,
                image: 'images/Attieke.jpg'
            },
            {
                id: 'ayimolou',
                name: 'Ayimolou',
                description: 'Accompagn√© de sauce piment√©e, viande de b≈ìuf & poisson frit',
                price: 3395,
                image: 'images/Ayimolou.jpg'
            }
        ];

        const extras = [
            { id: 'bissap', name: 'Jus de Bissap', price: 300, icon: 'ü•§' },
            { id: 'gingembre', name: 'Jus de Gingembre', price: 300, icon: 'ü•§' },
            { id: 'eau', name: 'Eau min√©rale', price: 200, icon: 'üíß' }
        ];

        // ===== √âTAT DU PANIER =====
        let cart = {};
        let currentDish = null;
        let modalQuantity = 1;
        let selectedOption = null;
        let userLocation = null;

        // ===== G√âOLOCALISATION =====
        function getLocation() {
            const geoButton = document.getElementById('geoButton');
            const geoButtonText = document.getElementById('geoButtonText');
            const geoStatus = document.getElementById('geoStatus');
            const locationInput = document.getElementById('location');

            // V√©rifier si la g√©olocalisation est support√©e
            if (!navigator.geolocation) {
                showGeoStatus('G√©olocalisation non support√©e par votre navigateur', 'error');
                return;
            }

            // √âtat de chargement
            geoButton.classList.add('loading');
            geoButton.disabled = true;
            geoButtonText.textContent = 'D√©tection en cours...';
            geoStatus.className = 'geo-status';
            geoStatus.style.display = 'none';

            // Options de g√©olocalisation
            const options = {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            };

            // Demander la position
            navigator.geolocation.getCurrentPosition(
                // Succ√®s
                function(position) {
                    const lat = position.coords.latitude.toFixed(6);
                    const lon = position.coords.longitude.toFixed(6);
                    
                    userLocation = {
                        latitude: lat,
                        longitude: lon,
                        accuracy: position.coords.accuracy
                    };

                    // Afficher la position
                    locationInput.value = `${lat}, ${lon}`;
                    
                    // R√©initialiser le bouton
                    geoButton.classList.remove('loading');
                    geoButton.disabled = false;
                    geoButtonText.textContent = 'Position d√©tect√©e ‚úì';
                    
                    // Message de succ√®s
                    showGeoStatus(`Position d√©tect√©e avec pr√©cision de ${Math.round(position.coords.accuracy)}m`, 'success');

                    // Optionnel : essayer d'obtenir l'adresse via reverse geocoding
                    // (n√©cessiterait une API externe comme OpenStreetMap Nominatim)
                },
                // Erreur
                function(error) {
                    geoButton.classList.remove('loading');
                    geoButton.disabled = false;
                    geoButtonText.textContent = 'R√©essayer la d√©tection';

                    let errorMessage = '';
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage = 'Autorisation refus√©e. Vous pouvez saisir votre quartier manuellement.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage = 'Position indisponible. V√©rifiez votre connexion.';
                            break;
                        case error.TIMEOUT:
                            errorMessage = 'D√©lai d√©pass√©. R√©essayez ou saisissez votre quartier.';
                            break;
                        default:
                            errorMessage = 'Erreur inconnue. Vous pouvez saisir votre quartier manuellement.';
                    }
                    
                    showGeoStatus(errorMessage, 'error');
                },
                options
            );
        }

        function showGeoStatus(message, type) {
            const geoStatus = document.getElementById('geoStatus');
            geoStatus.textContent = message;
            geoStatus.className = `geo-status ${type}`;
            geoStatus.style.display = 'block';

            // Masquer automatiquement apr√®s 5 secondes pour le succ√®s
            if (type === 'success') {
                setTimeout(() => {
                    geoStatus.style.display = 'none';
                }, 5000);
            }
        }

        // ===== GESTION HEADER STICKY =====
        const header = document.getElementById('header');
        const hamburger = document.getElementById('hamburger');
        const mobileMenu = document.getElementById('mobileMenu');
        const menuOverlay = document.getElementById('menuOverlay');

        // Changement header au scroll
        window.addEventListener('scroll', () => {
            if (window.scrollY > 100) {
                header.classList.add('scrolled');
                header.classList.remove('transparent');
            } else {
                header.classList.remove('scrolled');
                header.classList.add('transparent');
            }
        });

        // Toggle menu hamburger
        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            mobileMenu.classList.toggle('active');
            menuOverlay.classList.toggle('active');
        });

        // Fermer menu au clic sur overlay
        menuOverlay.addEventListener('click', () => {
            hamburger.classList.remove('active');
            mobileMenu.classList.remove('active');
            menuOverlay.classList.remove('active');
        });

        // Fermer menu au clic sur lien
        document.querySelectorAll('.mobile-menu nav a').forEach(link => {
            link.addEventListener('click', () => {
                hamburger.classList.remove('active');
                mobileMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
            });
        });

        // ===== CAROUSEL HERO =====
        let currentSlide = 0;
        const slides = document.querySelectorAll('.hero-slide');
        const dots = document.querySelectorAll('.carousel-dot');
        const totalSlides = slides.length;
        const heroCarousel = document.getElementById('heroCarousel');
        let autoPlayInterval;
        let touchStartX = 0;
        let touchEndX = 0;

        // Fonction pour afficher un slide sp√©cifique
        function goToSlide(index) {
            // Retirer la classe active de l'ancien slide et dot
            slides[currentSlide].classList.remove('active');
            dots[currentSlide].classList.remove('active');
            
            // Mettre √† jour l'index
            currentSlide = index;
            
            // Ajouter la classe active au nouveau slide et dot
            slides[currentSlide].classList.add('active');
            dots[currentSlide].classList.add('active');
        }

        // Fonction pour passer au slide suivant
        function showNextSlide() {
            const nextSlide = (currentSlide + 1) % totalSlides;
            goToSlide(nextSlide);
        }

        // Fonction pour passer au slide pr√©c√©dent
        function showPrevSlide() {
            const prevSlide = (currentSlide - 1 + totalSlides) % totalSlides;
            goToSlide(prevSlide);
        }

        // D√©marrer le carousel automatique
        function startAutoPlay() {
            autoPlayInterval = setInterval(showNextSlide, 5000);
        }

        // Arr√™ter le carousel automatique
        function stopAutoPlay() {
            clearInterval(autoPlayInterval);
        }

        // Gestion des clics sur les dots
        dots.forEach((dot, index) => {
            dot.addEventListener('click', () => {
                goToSlide(index);
                stopAutoPlay();
                startAutoPlay(); // Red√©marrer apr√®s interaction
            });
        });

        // ===== SWIPE MOBILE =====
        // D√©tecter le d√©but du swipe
        heroCarousel.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
            stopAutoPlay(); // Pause pendant l'interaction
        }, { passive: true });

        // D√©tecter la fin du swipe
        heroCarousel.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
            startAutoPlay(); // Red√©marrer apr√®s interaction
        }, { passive: true });

        // G√©rer la direction du swipe
        function handleSwipe() {
            const swipeThreshold = 50; // Distance minimale pour consid√©rer un swipe
            const diff = touchStartX - touchEndX;

            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // Swipe vers la gauche - slide suivant
                    showNextSlide();
                } else {
                    // Swipe vers la droite - slide pr√©c√©dent
                    showPrevSlide();
                }
            }
        }

        // Pause au survol (desktop uniquement)
        if (window.matchMedia('(min-width: 768px)').matches) {
            heroCarousel.addEventListener('mouseenter', stopAutoPlay);
            heroCarousel.addEventListener('mouseleave', startAutoPlay);
        }

        // D√©marrer le carousel au chargement
        startAutoPlay();

        // ===== INITIALISATION =====
        function init() {
            renderMenu();
            renderExtras();
            updateCart();
        }

        // ===== RENDU DU MENU =====
        function renderMenu() {
            const menuGrid = document.getElementById('menuGrid');
            menuGrid.innerHTML = dishes.map(dish => {
                const hasOptions = dish.options !== undefined;
                
                return `
                    <div class="dish-card">
                        <div class="dish-image ${dish.image ? '' : 'placeholder'}">
                            ${dish.image ? 
                                `<img src="${dish.image}" alt="${dish.name}" loading="lazy">` : 
                                `Image de ${dish.name}`
                            }
                        </div>
                        <div class="dish-content">
                            <h3 class="dish-name">${dish.name}</h3>
                            <p class="dish-description">${dish.description}</p>
                            <div class="dish-footer">
                                <span class="dish-price">${dish.price} F</span>
                                ${hasOptions ? 
                                    `<button type="button" class="add-dish-btn" onclick="openDishOptions('${dish.id}')">Choisir</button>` :
                                    `<div class="quantity-controls">
                                        <button type="button" class="qty-btn" onclick="decreaseQuantity('${dish.id}')">‚àí</button>
                                        <span class="qty-display" id="qty-${dish.id}">0</span>
                                        <button type="button" class="qty-btn" onclick="increaseQuantity('${dish.id}')">+</button>
                                    </div>`
                                }
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ===== RENDU DES EXTRAS =====
        function renderExtras() {
            const extrasGrid = document.getElementById('extrasGrid');
            extrasGrid.innerHTML = extras.map(extra => `
                <div class="extra-item">
                    <div class="extra-info">
                        <div class="extra-name">${extra.icon} ${extra.name}</div>
                        <div class="extra-price">${extra.price} F</div>
                    </div>
                    <div class="quantity-controls">
                        <button type="button" class="qty-btn" onclick="decreaseQuantity('${extra.id}')">‚àí</button>
                        <span class="qty-display" id="qty-${extra.id}">0</span>
                        <button type="button" class="qty-btn" onclick="increaseQuantity('${extra.id}')">+</button>
                    </div>
                </div>
            `).join('');
        }

        // ===== GESTION QUANTIT√âS (plats sans options) =====
        function increaseQuantity(id) {
            const dish = dishes.find(d => d.id === id);
            if (!dish.options) {
                const cartKey = id;
                if (!cart[cartKey]) {
                    cart[cartKey] = { dish: dish, quantity: 0 };
                }
                cart[cartKey].quantity++;
                updateCart();
            }
        }

        function decreaseQuantity(id) {
            const cartKey = id;
            if (cart[cartKey] && cart[cartKey].quantity > 0) {
                cart[cartKey].quantity--;
                if (cart[cartKey].quantity === 0) {
                    delete cart[cartKey];
                }
                updateCart();
            }
        }

        // ===== MODAL OPTIONS PLAT =====
        function openDishOptions(dishId) {
            const dish = dishes.find(d => d.id === dishId);
            if (!dish) return;

            currentDish = dish;
            modalQuantity = 1;
            selectedOption = null;

            // Remplir la modal
            document.getElementById('modalDishName').textContent = dish.name;
            document.getElementById('modalDishPrice').textContent = dish.price + ' F';
            document.getElementById('modalQuantity').textContent = modalQuantity;

            // G√©n√©rer les options
            const modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = `
                <div class="option-section">
                    <label class="option-label">${dish.options.label}</label>
                    ${dish.options.choices.map((choice, index) => `
                        <div class="option-choice" onclick="selectOption('${choice.id}')">
                            <input type="radio" 
                                   name="dish-option" 
                                   id="option-${choice.id}" 
                                   value="${choice.id}"
                                   onchange="selectOption('${choice.id}')">
                            <label for="option-${choice.id}">${choice.label}</label>
                        </div>
                    `).join('')}
                </div>
            `;

            // D√©sactiver le bouton par d√©faut
            document.getElementById('addToCartBtn').disabled = true;

            // Afficher la modal
            document.getElementById('optionsOverlay').classList.add('active');
            document.getElementById('dishOptionsModal').classList.add('active');
        }

        function selectOption(optionId) {
            selectedOption = optionId;

            // Mettre √† jour visuellement
            document.querySelectorAll('.option-choice').forEach(choice => {
                choice.classList.remove('selected');
            });
            const selectedChoice = document.querySelector(`#option-${optionId}`).closest('.option-choice');
            selectedChoice.classList.add('selected');

            // Activer le bouton
            document.getElementById('addToCartBtn').disabled = false;
        }

        function increaseModalQuantity() {
            modalQuantity++;
            document.getElementById('modalQuantity').textContent = modalQuantity;
        }

        function decreaseModalQuantity() {
            if (modalQuantity > 1) {
                modalQuantity--;
                document.getElementById('modalQuantity').textContent = modalQuantity;
            }
        }

        function addDishToCart() {
            if (!currentDish || !selectedOption) return;

            const cartKey = `${currentDish.id}-${selectedOption}`;
            
            if (!cart[cartKey]) {
                cart[cartKey] = {
                    dish: currentDish,
                    option: selectedOption,
                    optionLabel: currentDish.options.choices.find(c => c.id === selectedOption).label,
                    quantity: 0
                };
            }

            cart[cartKey].quantity += modalQuantity;

            // Fermer la modal
            closeDishOptions();
            updateCart();
        }

        function closeDishOptions() {
            document.getElementById('optionsOverlay').classList.remove('active');
            document.getElementById('dishOptionsModal').classList.remove('active');
            currentDish = null;
            selectedOption = null;
            modalQuantity = 1;
        }

        // Fermer la modal au clic sur overlay
        document.getElementById('optionsOverlay').addEventListener('click', closeDishOptions);

        // ===== MISE √Ä JOUR DU PANIER =====
        function updateCart() {
            // Mise √† jour des affichages de quantit√© pour plats sans options
            dishes.filter(d => !d.options).forEach(dish => {
                const qtyElement = document.getElementById(`qty-${dish.id}`);
                if (qtyElement) {
                    const cartItem = cart[dish.id];
                    qtyElement.textContent = cartItem ? cartItem.quantity : 0;
                }
            });

            // Mise √† jour des affichages pour extras
            extras.forEach(item => {
                const qtyElement = document.getElementById(`qty-${item.id}`);
                if (qtyElement) {
                    const cartItem = cart[item.id];
                    qtyElement.textContent = cartItem ? cartItem.quantity : 0;
                }
            });

            // Mise √† jour du r√©sum√©
            const cartSummary = document.getElementById('cartSummary');
            const submitBtn = document.getElementById('submitBtn');
            
            const items = Object.keys(cart);
            if (items.length === 0) {
                cartSummary.innerHTML = '<div class="cart-empty">Votre panier est vide</div>';
                submitBtn.disabled = true;
                return;
            }

            let total = 0;
            let html = '';

            items.forEach(key => {
                const item = cart[key];
                const itemName = item.dish ? item.dish.name : (extras.find(e => e.id === key)?.name || '');
                const itemPrice = item.dish ? item.dish.price : (extras.find(e => e.id === key)?.price || 0);
                const optionText = item.optionLabel ? ` (${item.optionLabel})` : '';
                const subtotal = itemPrice * item.quantity;
                total += subtotal;

                html += `
                    <div class="cart-item">
                        <span>${itemName}${optionText} x${item.quantity}</span>
                        <span>${subtotal} F</span>
                    </div>
                `;
            });

            html += `
                <div class="cart-total">
                    <span>Total</span>
                    <span>${total} F</span>
                </div>
            `;

            cartSummary.innerHTML = html;
            submitBtn.disabled = false;
        }

        // ===== G√âN√âRATION MESSAGE COMMANDE =====
        function generateOrderMessage() {
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const location = document.getElementById('location').value;
            const quartier = document.getElementById('quartier').value;
            const time = document.getElementById('time').value;
            const notes = document.getElementById('notes').value;

            let message = `üçΩÔ∏è *NOUVELLE COMMANDE*\n\n`;
            message += `üë§ *Client:* ${name}\n`;
            message += `üì± *T√©l:* ${phone}\n`;
            
            if (location) {
                message += `üìç *GPS:* ${location}\n`;
                message += `üó∫Ô∏è *Lien:* https://maps.google.com/?q=${location}\n`;
            }
            
            message += `üèòÔ∏è *Rep√®re:* ${quartier}\n`;
            message += `üïê *Heure:* ${time}\n\n`;
            message += `üõí *Commande:*\n`;

            let total = 0;
            Object.keys(cart).forEach(key => {
                const item = cart[key];
                const itemName = item.dish ? item.dish.name : (extras.find(e => e.id === key)?.name || '');
                const itemPrice = item.dish ? item.dish.price : (extras.find(e => e.id === key)?.price || 0);
                const optionText = item.optionLabel ? ` (${item.optionLabel})` : '';
                const subtotal = itemPrice * item.quantity;
                total += subtotal;
                message += `‚Ä¢ ${itemName}${optionText} x${item.quantity} = ${subtotal} F\n`;
            });

            message += `\nüí∞ *Total: ${total} F*\n`;
            message += `üíµ Paiement √† la livraison\n`;

            if (notes) {
                message += `\nüìù *Notes:* ${notes}`;
            }

            return message;
        }

        // ===== SOUMISSION FORMULAIRE =====
        document.getElementById('orderForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const message = generateOrderMessage();
            const phoneNumber = '22890123456'; // √Ä REMPLACER par le vrai num√©ro WhatsApp
            
            // Tentative d'ouverture WhatsApp
            const whatsappURL = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            
            // Ouvrir WhatsApp
            window.open(whatsappURL, '_blank');
            
            // Afficher modal de confirmation
            setTimeout(() => {
                const successModal = document.getElementById('successModal');
                successModal.style.display = 'flex';
            }, 500);

            // Fallback : si WhatsApp ne s'ouvre pas, l'utilisateur peut copier le message
            console.log('Message de commande:', message);
        });

        // ===== FERMETURE MODAL SUCCESS =====
        function closeSuccessModal() {
            const successModal = document.getElementById('successModal');
            successModal.style.display = 'none';
            // R√©initialiser le formulaire
            document.getElementById('orderForm').reset();
            document.getElementById('location').value = '';
            document.getElementById('geoButtonText').textContent = 'Utiliser ma position actuelle';
            document.getElementById('geoStatus').style.display = 'none';
            cart = {};
            userLocation = null;
            updateCart();
        }

        // ===== D√âMARRAGE =====
        init();
    </script>
</body>
</html>